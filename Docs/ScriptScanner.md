# class ScriptScanner : TextScanner
Extends TextScanner with methods useful for script scanning and parsing.

> **Incorporates the following:**
> - Handles *comments*: Line and block (with nesting) comments.
> - Skip whitespace and comments.
> - Scan delimited strings and blocks.
> - Standard identifier scanning.
> - Scan list structures.

| Members | Description |
| :---- | :------ |
| ***Constructor:*** |  |
| ``C: ScriptScanner(string source = "", ScanErrorLog errorLog = null)`` | Create a ScripScanner with given source string and 'internal' (errorLog == null) or 'external' ScanErrorLog.<br/> |
| ***Comment configuration:*** | *ScriptScanner supports Line (default `//`) and Block (default `/* ... */`) comments which may be reconfigured below.* |
| ``M: ScriptScanner SetScriptComment(ScriptComment scriptComment)`` | Set comment configuration via a previously defined ScriptComment.<br/><br/>**Parameters:**<br/><code>scriptComment:</code> ScriptComment object<br/><br/>**Returns:**<br/>ScriptScanner for fluent chaining. |
| ``M: ScriptScanner SetScriptComment(string lineComment = "//", string blockCommentStart = "/*", string blockCommentEnd = "*/")`` | Set comment configuration:<br/>- For block comments Start and End must both be valid to enable block comments.<br/><br/>**Parameters:**<br/><code>lineComment:</code> Line comment (null/empty for none).<br/><code>blockCommentStart:</code> Block comment start (null/empty for none).<br/><code>blockCommentEnd:</code> Block comment end (null/empty for none).<br/><br/>**Returns:**<br/>ScriptScanner for fluent chaining. |
| ***Token operation extensions:*** |  |
| ``P: string StripToken`` | Get current token stripped of comments.<br/> |
| ``P: string TrimStripToken`` | Get current token trimmed and stripped of comments.<br/> |
| ***Delimited Strings:*** |  |
| ``P: string StringDelim`` | Get or Set the String Delimiters to use (default = "'\`).<br/> |
| ``M: bool IsStringDelim()`` | Query if character at Index is one of the StringDelimiters.<br/> |
| ***Script utilities:*** |  |
| ``M: bool StrLit()`` | Scan a delimited String Literal:<br/>- Current Index must be at the starting delimiter ("\`' etc).<br/>- NOTE: A string literal may NOT span a line.<br/>- Token contains the string (excluding delimiters).<br/><br/>**Returns:**<br/>True: if there was a string literal and Index positioned after ending delimiter.<br/>False: for no string or Eos - Index unchanged. |
| ``M: bool ValueOrStrLit(string termChars, bool orToEos = false)`` | Scan either a StrLit or result of ScanToAny(termChars, orToEos) and ValidToken():<br/>- If Index is at a StringDelim - returns the result of StrLit().<br/>- Else returns the result of ScanToAny(termChars, orToEos) and ValidToken() (i.e non-blank value).<br/>- Use Token to retrieve the value.<br/><br/>**Returns:**<br/>Success of the scan. |
| ``M: bool StdIdent()`` | Scan Standard Identifier of the form: <code>(letter \| _)+ (letterordigit \| _)\*</code>.<br/><br/>**Returns:**<br/>True for valid identifier (available via Token) else false. |
| ``M: bool StdIdent2()`` | Scan Standard Identifier of the form: <code>(letter \| _)+ (letterordigit \| _ \| -)\*</code>.<br/><br/>**Returns:**<br/>True for valid identifier (available via Token) else false. |
| ``M: bool ScanBlock(string blockDelims = "{}", bool isOpen = false)`` | Scan a block delimited by blockDelims (E.g "\{\}" or "()" or "[]" etc.): <br/>- Handles Nesting and ignores any block delimiters inside comments or string literals (delimited by StringDelim).<br/>- Token contains the block content excluding the block delimiters.<br/><br/>**Parameters:**<br/><code>blockDelims:</code> String with opening and closing block delimiters (default = "\{\}).<br/><code>isOpen:</code> False - current Index at start of block else Index just inside block.<br/><br/>**Returns:**<br/>True for a valid block (Index positioned after block) else false and Logs an error (Index unchanged). |
| ``M: static  string StripComments(string source, ScriptComment scriptComment)`` | Static method: Return the source string with all line and block comments removed.<br/> |
| ``M: List<string> ScanList(string delims = "()", char separator = ',', string block = "[]")`` | Scan a List of the form: ( item1, item 2, ...):<br/>- Note: The next non-whitespace character must be the Opening list delimiter.<br/>- Item type 1: All text up to closing delimiter or separator (logged trimmed).<br/>- Item type 2: A string literal - may NOT span a line! (logged verbatim excluding string delimiters).<br/>- Item type 3: Block delimited text (logged verbatim excluding block delimiters) - use for multi-line text. <br/>- Blank items are not recorded.<br/><br/>**Parameters:**<br/><code>delims:</code> Opening and closing list delimiter (default = "()")<br/><code>separator:</code> List item separator (default = ,).<br/><code>block:</code> Opening and closing Block delimiters (default = "[]").<br/><br/>**Returns:**<br/>List of strings else null and error logged in ErrorLog. |
| ``M: bool ScanList(out List<string> list, string delims = "()", char separator = ',', string block = "[]")`` | Scan a List of the form: ( item1, item 2 ... ):<br/>- Note: The next non-whitespace character must be the Opening list delimiter.<br/>- Item type 1: All text up to closing delimiter or separator (logged trimmed).<br/>- Item type 2: A string literal - may NOT span a line! (logged verbatim  excluding string delimiters).<br/>- Item type 3: Block delimited text (logged verbatim excluding block delimiters) - use for multi-line text. <br/>- Blank items are not recorded.<br/><br/>**Parameters:**<br/><code>delims:</code> Opening and closing list delimiter (default = "()").<br/><code>separator:</code> List item separator (default = ,).<br/><code>block:</code> Opening an closing Block delimiters (default = "[]").<br/><br/>**Returns:**<br/>True and List of strings in out list (Index after list), else false and error logged in ErrorLog. |
| ***Whitespace and Comment skipping:*** |  |
| ``M: bool SkipSp()`` | Skip Spaces (" \t").<br/><br/>**Returns:**<br/>True if not at Eos after skipping else False. |
| ``M: bool SkipWS(string wsChars = " \r\n\t")`` | Skip given White Space characters (default: " \r\n\t").<br/><br/>**Returns:**<br/>True if not at Eos after skipping else False. |
| ``M: bool SkipWSC(bool termNL = false, string spaceChars = " \t")`` | Skip White Space and comments:<br/>- White space: spaceChars + "\r\n" if termNL is false.<br/>- Block comments handle nesting and comments embedded in delimited strings.<br/>- Set termNL to true to stop at a newline, including the newline at the end of a line comment.<br/><br/>**Parameters:**<br/><code>termNL:</code> True to stop at a newline, including the newline at the end of a line comment.<br/><code>spaceChars:</code> Characters to regard as white-space (default: " \t").<br/><br/>**Returns:**<br/>True: Whitespace and comments skipped and Index directly after, or possibly at a newline if termNL is true.<br/>  False: Eos or comment error - Index unchanged and error logged (if comment error). |
| ``M: bool IsComment()`` | Query if Index is currently at a comment.<br/> |
| ``M: bool SkipComment(bool termNL = false)`` | Skip consecutive sequence of comments: <br/>- NOTE: Index must be positioned at the start of a comment else the operation is ignored.<br/>- Line comments are skipped to Eol/Eos.<br/>- Block comments handle nesting and comments embedded in delimited strings.<br/>- Set termNL to true to stop at a newline, including the newline at the end of a line comment.<br/><br/>**Parameters:**<br/><code>termNL:</code> True to stop at a newline, including the newline at the end of a line comment.<br/><br/>**Returns:**<br/>True: Comment skipped and Index positioned after comment, or possibly at a newline if termNL is true.<br/>False: Eos or comment error - Index unchanged and error logged (if comment error). |
